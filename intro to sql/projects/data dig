/* Put your data in here and query it! */
CREATE TABLE TOP_MOVIES
(id INTEGER PRIMARY KEY AUTOINCREMENT,
name TEXT,rating INTEGER,RELEASED_YEAR INTEGER);
INSERT INTO top_movies(name,rating,released_year) VALUES("The Shawshank Redemption",9.3,1994);
INSERT INTO top_movies(name,rating,released_year)
VALUES("THE GOD FATHER",9.2,1972);
INSERT INTO top_movies(name,rating,released_year)VALUES("THE GOD FATHER PARTII",9.0,1980);
INSERT INTO top_movies(name,rating,released_year)VALUES("THE DARK KNIGHT",8.9,2008);
INSERT INTO top_movies(name,rating,released_year)VALUES("SCHINDLER'S LIST",8.8,1993);
INSERT INTO top_movies(name,rating,released_year)VALUES("12 ANGRY MEN",8.3,1957);
INSERT INTO top_movies(name,rating,released_year)VALUES("PULP FICTION",8.8,1994);
INSERT INTO top_movies(name,rating,released_year)VALUES ("THE LORD OF THE RINGS;RETURN OF THE KING",8.8,2003);
INSERT INTO top_movies(name,rating,released_year)VALUES ("THE GOOD THE BAD THE UGLY",8.8,1966);

INSERT INTO top_movies(name,rating,released_year)VALUES("FOREST GUMP",8.7,1994);

INSERT INTO top_movies(name,rating,released_year)VALUES("INCEPTION",8.6,2010);
INSERT INTO top_movies(name,rating,released_year)VALUES("GOD FELLAS",8.7,1990);
INSERT INTO top_movies(name,rating,released_year)VALUES("THE MATRIX",8.7,1999);
INSERT INTO top_movies(name,rating,released_year)VALUES("CITY OF GOD",8.6,2002);
INSERT INTO top_movies(name,rating,released_year)VALUES("SE7VEN",8.6,1995);
INSERT INTO top_movies(name,rating,released_year)VALUES("SPIRITED AWAY",8.5,2001);
INSERT INTO top_movies(name,rating,released_year)VALUES("INTERSTELLAR",8.5,2014);
INSERT INTO top_movies(name,rating,released_year)VALUES("THE LION KING",8.4,1994);
INSERT INTO top_movies(name,rating,released_year)VALUES("AMELIE",8.3,2001);
INSERT INTO top_movies(name,rating,released_year)VALUES("3IDIOTS",8.2,2009);
SELECT *FROM TOP_MOVIES;
SELECT AVG(RATING) FROM TOP_MOVIES GROUP BY RELEASED_YEAR;
SELECT MAX(RATING) FROM TOP_MOVIES GROUP BY NAME;
SELECT MIN(RATING)FROM TOP_MOVIES GROUP BY NAME;
SELECT *FROM TOP_MOVIES WHERE RELEASED_YEAR >1990 ORDER BY RELEASED_YEAR;
SELECT *FROM TOP_MOVIES WHERE RELEASED_YEAR <1990
AND RATING >9;
SELECT NAME FROM TOP_MOVIES WHERE NAME="THE" OR RATING >9;
SELECT NAME,SUM(RATING) AS GIVEN_RATING FROM TOP_MOVIES GROUP BY NAME
HAVING RATING > 8.8;
SELECT NAME,
CASE 
WHEN RATING>8.5 THEN"HIT"
WHEN RATING>9 THEN"BLOCK_BUSTER"
WHEN RATING<8.5 THEN "AVERAGE"
ELSE "NOT BAD"
END AS "BOXOFFICE_RATING"
FROM TOP_MOVIES
GROUP BY "BOXOFFICE_RATING";
SELECT COUNT(*),
CASE 
WHEN RATING>8.5 THEN"HIT"
WHEN RATING>9 THEN"BLOCK_BUSTER"
WHEN RATING<8.5 THEN "AVERAGE"
ELSE "NOT BAD"
END AS "BOXOFFICE_RATING"
FROM TOP_MOVIES
GROUP BY "BOXOFFICE_RATING";
